@import "tailwindcss";

@theme {
  /* Layout */
  --max-width: 1100px;
  --spacing-content: 6rem;
  
  /* Spacing Scale */
  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-5: 1.25rem;
  --space-6: 1.5rem;
  --space-8: 2rem;
  --space-10: 2.5rem;
  
  /* Typography */
  --font-mono: ui-monospace, Menlo, Monaco, 'Cascadia Mono', 'Segoe UI Mono',
    'Roboto Mono', 'Oxygen Mono', 'Ubuntu Monospace', 'Source Code Pro',
    'Fira Mono', 'Droid Sans Mono', 'Courier New', monospace;

  /* Colors - Light Mode */
  --color-text: 0 0 0;
  --color-bg-start: 214 219 220;
  --color-bg-end: 255 255 255;
  --color-callout: 238 240 241;
  --color-callout-border: 172 175 176;
  --color-card: 180 185 188;
  --color-card-border: 131 134 135;

  /* Semantic Design Tokens */
  --radius: 12px;
  --radius-sm: 6px;
  --border-subtle: 1px solid rgb(var(--color-card-border) / 0.15);
  --border-muted: 1px solid rgb(var(--color-card-border) / 0.25);
  --bg-subtle: rgb(var(--color-card) / 0.1);
  --bg-callout: rgb(var(--color-callout) / 0.5);
}

@media (prefers-color-scheme: dark) {
  @theme {
    /* Colors - Dark Mode */
    --color-text: 255 255 255;
    --color-bg-start: 0 0 0;
    --color-bg-end: 0 0 0;
    --color-callout: 20 20 20;
    --color-callout-border: 108 108 108;
    --color-card: 100 100 100;
    --color-card-border: 200 200 200;
  }
}

@layer base {
  * {
    box-sizing: border-box;
    padding: 0;
    margin: 0;
  }

  html,
  body {
    max-width: 100vw;
    overflow-x: hidden;
  }

  body {
    color: rgb(var(--color-text));
    background: linear-gradient(
        to bottom,
        transparent,
        rgb(var(--color-bg-end))
      )
      rgb(var(--color-bg-start));
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  @media (prefers-color-scheme: dark) {
    html {
      color-scheme: dark;
    }
  }
}

@layer components {
  /* Buttons */
  .btn {
    @apply inline-flex items-center transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/40;
    border-radius: var(--radius);
    border: var(--border-subtle);
    padding: var(--space-4) var(--space-5);
    background: transparent;
  }
  .btn:hover { background: var(--bg-subtle); }

  .btn-icon {
    @apply inline-flex h-8 w-8 items-center justify-center transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/40;
    border-radius: var(--radius-sm);
    border: var(--border-muted);
    background: transparent;
  }
  .btn-icon:hover { background: var(--bg-subtle); }

  .btn-danger {
    @apply inline-flex items-center text-red-200 transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500/40;
    border-radius: var(--radius-sm);
    border: 1px solid rgb(248 113 113 / 0.4);
    padding: var(--space-1) var(--space-3);
    background: transparent;
  }
  .btn-danger:hover { background: rgb(248 113 113 / 0.1); }

  /* Form Elements */
  .input {
    @apply h-8 transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/40;
    border-radius: var(--radius-sm);
    border: var(--border-muted);
    padding: 0 var(--space-2);
    background: transparent;
  }

  /* Layout Components */
  .page-layout {
    @apply flex min-h-screen w-full flex-col items-center justify-between;
    padding: var(--spacing-content);
  }

  .page-header {
    @apply flex w-full items-center justify-between text-[0.85rem] z-20 px-4;
    max-width: var(--max-width);
    font-family: var(--font-mono);
  }

  .product-grid {
    @apply grid w-full grid-cols-1 justify-center md:grid-cols-2 lg:grid-cols-4;
    max-width: var(--max-width);
    margin-top: var(--space-8);
    gap: var(--space-4);
    position: relative;
  }

  .checkout-layout {
    @apply grid w-full grid-cols-1 md:grid-cols-[3fr_1.2fr] px-4;
    max-width: var(--max-width);
    margin-top: var(--space-8);
    gap: var(--space-6);
  }

  /* Content Components */
  .card {
    @apply cursor-pointer text-left transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/40;
    border-radius: var(--radius);
    border: var(--border-subtle);
    padding: var(--space-4) var(--space-5);
    background: transparent;
  }
  .card:hover { background: var(--bg-subtle); }

  .callout {
    border-radius: var(--radius);
    background: var(--bg-callout);
    border: 1px solid rgb(var(--color-callout-border) / 0.3);
    padding: var(--space-4);
  }

  .summary-box {
    border-radius: var(--radius);
    border: var(--border-subtle);
    padding: var(--space-4);
  }
}

/* Lightweight loading visuals */
@keyframes spin {
  to { transform: rotate(360deg); }
}

@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

@layer components {
  .spinner {
    width: 1rem;
    height: 1rem;
    border-radius: 9999px;
    border: 2px solid rgb(var(--color-card-border) / 0.35);
    border-top-color: transparent;
    border-left-color: transparent;
    animation: spin 0.8s linear infinite;
  }

  /* Nicer, subtle ring spinner */
  .spinner-ring {
    width: 1.25rem;
    height: 1.25rem;
    border-radius: 9999px;
    background: conic-gradient(#60a5fa 0deg, #60a5fa 90deg, transparent 90deg);
    -webkit-mask: radial-gradient(farthest-side, #000 70%, transparent 71%);
            mask: radial-gradient(farthest-side, #000 70%, transparent 71%);
    animation: spin 0.8s linear infinite;
  }

  .skeleton {
    border-radius: var(--radius);
    border: var(--border-subtle);
    background: linear-gradient(90deg,
      rgb(var(--color-card) / 0.06) 0%,
      rgb(var(--color-card) / 0.12) 50%,
      rgb(var(--color-card) / 0.06) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.4s ease-in-out infinite, fade-in 0.25s ease both;
    min-height: 9.5rem; /* Match card min-height */
    padding: var(--space-4) var(--space-5); /* Match card padding to align lines */
  }

  .skeleton-line {
    height: 0.875rem;
    border-radius: var(--radius-sm);
    background: rgb(var(--color-card) / 0.15); /* Subtle line color */
  }

  .loading-container {
    min-height: 1.75rem; /* Reserves space for indicator */
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fade-in 0.3s ease-in;
  }

  .loading-overlay {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    bottom: var(--space-4);
    z-index: 10;
    display: flex;
    align-items: center;
    gap: var(--space-2);
    animation: fade-in 0.2s ease-in;
    pointer-events: none;
  }
}
